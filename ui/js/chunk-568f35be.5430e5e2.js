(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-568f35be"],{"00ee":function(e,t,r){"use strict";var a=r("b622"),s=a("toStringTag"),n={};n[s]="z",e.exports="[object z]"===String(n)},"0d26":function(e,t,r){"use strict";var a=r("e330"),s=Error,n=a("".replace),o=function(e){return String(new s(e).stack)}("zxcasd"),c=/\n\s*at [^:]*:[^\n]*/,i=c.test(o);e.exports=function(e,t){if(i&&"string"==typeof e&&!s.prepareStackTrace)while(t--)e=n(e,c,"");return e}},1787:function(e,t,r){"use strict";var a=r("861d");e.exports=function(e){return a(e)||null===e}},"17ac":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"用户活动日志",name:"act_log"}},[t("AuditActLog",{ref:"auditActLog"})],1),t("el-tab-pane",{attrs:{label:"用户访问日志",name:"access_audit"}},[t("AuditAccess",{ref:"auditAccess"})],1)],1)],1)],1)},s=[],n=(r("14d9"),function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,rules:e.rules,inline:!0}},[t("el-form-item",{attrs:{label:"用户名:",prop:"username"}},[t("el-input",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),t("el-form-item",{attrs:{label:"源IP地址:",prop:"src"}},[t("el-input",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.src,callback:function(t){e.$set(e.searchForm,"src",t)},expression:"searchForm.src"}})],1),t("el-form-item",{attrs:{label:"目的IP地址:",prop:"dst"}},[t("el-input",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.dst,callback:function(t){e.$set(e.searchForm,"dst",t)},expression:"searchForm.dst"}})],1),t("el-form-item",{attrs:{label:"目的端口:",prop:"dst_port"}},[t("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.dst_port,callback:function(t){e.$set(e.searchForm,"dst_port",t)},expression:"searchForm.dst_port"}})],1),t("el-form-item",{attrs:{label:"访问协议："}},[t("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:e.searchForm.access_proto,callback:function(t){e.$set(e.searchForm,"access_proto",t)},expression:"searchForm.access_proto"}},e._l(e.access_proto,(function(e,r){return t("el-option",{key:r,attrs:{label:e.text,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"日期范围："}},[t("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",align:"left","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.searchForm.date,callback:function(t){e.$set(e.searchForm,"date",t)},expression:"searchForm.date"}})],1),t("el-form-item",{attrs:{label:"详情:"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"请输入关键字",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.info,callback:function(t){e.$set(e.searchForm,"info",t)},expression:"searchForm.info"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索 ")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.rest}},[e._v("重置搜索 ")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v("导出 ")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:e.tableData,"element-loading-text":"玩命加载中","element-loading-spinner":"el-icon-loading","default-sort":{prop:"id",order:"descending"},"header-cell-style":{backgroundColor:"#fcfcfc"},border:""},on:{"sort-change":e.sortChange}},[t("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"custom",width:"100"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"140"}}),t("el-table-column",{attrs:{prop:"src",label:"源IP地址",width:"140"}}),t("el-table-column",{attrs:{prop:"dst",label:"目的IP地址",width:"140"}}),t("el-table-column",{attrs:{prop:"dst_port",label:"目的端口",width:"85"}}),t("el-table-column",{attrs:{prop:"access_proto",label:"访问协议",width:"80",formatter:e.protoFormat}}),t("el-table-column",{attrs:{prop:"info",label:"详情"}}),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"160",formatter:e.tableDateFormat}})],1),t("div",{staticClass:"sh-20"}),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","pager-count":11,"current-page":e.currentPage,total:e.count},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.pageChange}})],1)}),o=[],c=(r("d9e2"),r("bc3a")),i=r.n(c),l={name:"auditAccess",mixins:[],data(){return{tableData:[],count:10,currentPage:1,idSort:1,activeName:"first",accessProtoArr:["","UDP","TCP","HTTPS","HTTP"],defSearchForm:{username:"",src:"",dst:"",dst_port:"",access_proto:"",info:"",date:["",""]},searchForm:{},access_proto:[{text:"UDP",value:"1"},{text:"TCP",value:"2"},{text:"HTTPS",value:"3"},{text:"HTTP",value:"4"}],maxExportNum:1e6,loading:!1,rules:{username:[{max:30,message:"长度小于 30 个字符",trigger:"blur"}],src:[{message:"请输入正确的IP地址",validator:this.validateIP,trigger:"blur"}],dst:[{message:"请输入正确的IP地址",validator:this.validateIP,trigger:"blur"}]}}},watch:{idSort:{handler(e,t){e!=t&&this.getData(1)}}},methods:{setSearchData(){this.searchForm=JSON.parse(JSON.stringify(this.defSearchForm))},handleSearch(){this.$refs["searchForm"].validate(e=>{if(!e)return console.log("error submit!!"),!1;this.getData(1)})},searchEnterFun(e){var t=window.event?e.keyCode:e.which;13==t&&this.handleSearch()},getData(e){this.loading=!0,this.searchForm.date||(this.searchForm.date=["",""]),this.searchForm.sort=this.idSort,i.a.get("/set/audit/list",{params:{page:e,search:this.searchForm}}).then(t=>{var r=t.data.data;console.log(r),this.tableData=r.datas,this.count=r.count,this.loading=!1,this.currentPage=e}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},pageChange(e){this.getData(e)},handleExport(){if(this.count>this.maxExportNum){var e=(this.maxExportNum+"").replace(/\d{1,3}(?=(\d{3})+$)/g,(function(e){return e+","}));return void this.$message.error("你导出的数据量超过"+e+"条，请调整搜索条件，再导出")}this.searchForm.date||(this.searchForm.date=["",""]);const t=this.$loading({lock:!0,text:"玩命导出中，请稍等片刻...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});i.a.get("/set/audit/export",{params:{search:this.searchForm}}).then(e=>{var r=e.data;if(r.code&&0!=r.code)return t.close(),void this.$message.error(r.msg);t.close(),this.$message.success("成功导出CSV文件");let a="data:text/csv;charset=utf-8,\ufeff"+r;this.createDownLoadClick(a,"anylink_audit_log_"+Date.parse(new Date)+".csv")}).catch(e=>{t.close(),this.$message.error("哦，请求出错"),console.log(e)})},createDownLoadClick(e,t){const r=document.createElement("a");r.href=encodeURI(e),r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)},protoFormat(e){var t=e.access_proto;if(0==e.access_proto)switch(e.protocol){case 6:t=2;break;case 17:t=1;break}return this.accessProtoArr[t]},rest(){console.log("rest"),this.setSearchData(),this.handleSearch()},validateIP(e,t,r){if(""===t||"undefined"===typeof t||null==t)r();else{const e=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e.test(t)||""===t?r():r(new Error("请输入正确的IP地址"))}},sortChange(e){let{order:t}=e;this.idSort="ascending"===t?2:1}}},u=l,d=(r("3085"),r("2877")),h=Object(d["a"])(u,n,o,!1,null,"386cebb0",null),p=h.exports,m=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:!0}},[t("el-form-item",[t("el-input",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:"",placeholder:"请输入用户名"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterFun.apply(null,arguments)}},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),t("el-form-item",[t("el-date-picker",{staticStyle:{width:"130px"},attrs:{type:"date",size:"mini",placeholder:"开始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.sdate,callback:function(t){e.$set(e.searchForm,"sdate",t)},expression:"searchForm.sdate"}})],1),t("el-form-item",[t("el-date-picker",{staticStyle:{width:"130px"},attrs:{type:"date",size:"mini",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.edate,callback:function(t){e.$set(e.searchForm,"edate",t)},expression:"searchForm.edate"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:"",placeholder:"操作类型"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.statusOps,(function(e,r){return t("el-option",{key:r,attrs:{label:e.value,value:e.key+1}})})),1)],1),t("el-form-item",[t("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",clearable:"",placeholder:"操作系统"},model:{value:e.searchForm.os,callback:function(t){e.$set(e.searchForm,"os",t)},expression:"searchForm.os"}},e._l(e.osOps,(function(e,r,a){return t("el-option",{key:a,attrs:{label:e,value:r+1}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索 ")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.rest}},[e._v("重置搜索 ")])],1)],1),t("el-table",{ref:"multipleTable",attrs:{data:e.tableData,"default-sort":{prop:"id",order:"descending"},"header-cell-style":{backgroundColor:"#fcfcfc"},border:""},on:{"sort-change":e.sortChange}},[t("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"custom",width:"100"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"140"}}),t("el-table-column",{attrs:{prop:"group_name",label:"登陆组",width:"100"}}),t("el-table-column",{attrs:{prop:"status",label:"操作类型",width:"92"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return e._l(e.statusOps,(function(a,s){return t("span",{key:s},[r.status==a.key?t("el-tag",{attrs:{size:"small","disable-transitions":"",type:a.tag}},[e._v(e._s(a.value))]):e._e()],1)}))}}])}),t("el-table-column",{attrs:{prop:"info",label:"操作详情","min-width":"200"}}),t("el-table-column",{attrs:{prop:"created_at",label:"操作时间",width:"150",formatter:e.tableDateFormat}}),t("el-table-column",{attrs:{prop:"os",label:"操作系统","min-width":"210"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return[e._l(e.osOps,(function(a,s,n){return t("span",{key:n},[e._v(" "+e._s(r.os==s?a:"")+" ")])})),t("div",{staticClass:"sub_txt"},[e._v("型号: "),""!=r.device_type?t("span",[e._v(e._s(r.device_type)+" / "+e._s(r.platform_version))]):t("span",[e._v(" - ")])])]}}])}),t("el-table-column",{attrs:{prop:"client",label:"客户端",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return[e._l(e.clientOps,(function(a,s,n){return t("span",{key:n},[e._v(" "+e._s(r.client==s?a:"")+" ")])})),e._v(" "+e._s(r.version)+" ")]}}])}),t("el-table-column",{attrs:{prop:"ip_addr",label:"内网IP",width:"120"}}),t("el-table-column",{attrs:{prop:"remote_addr",label:"外网IP",width:"120"}})],1),t("div",{staticClass:"sh-20"}),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","pager-count":11,"current-page":e.page,total:e.count},on:{"current-change":e.pageChange}})],1)},f=[],b={name:"List",components:{},mixins:[],created(){this.$emit("update:route_path",this.$route.path),this.$emit("update:route_name",["用户信息","登入日志"])},data(){return{page:1,grouNames:[],tableData:[],idSort:1,count:10,searchForm:{username:"",sdate:"",edate:"",status:"",os:""},statusOps:[],osOps:[],clientOps:[]}},watch:{idSort:{handler(e,t){e!=t&&this.getData(1)}}},methods:{handleSearch(){this.getData(1)},pageChange(e){this.getData(e)},searchEnterFun(e){var t=window.event?e.keyCode:e.which;13==t&&this.handleSearch()},getData(e){console.log(this.searchForm),this.page=e,i.a.get("/set/audit/act_log_list",{params:{page:e,username:this.searchForm.username||"",sdate:this.searchForm.sdate||"",edate:this.searchForm.edate||"",status:this.searchForm.status||"",os:this.searchForm.os||"",sort:this.idSort}}).then(e=>{var t=e.data.data;console.log(t),this.tableData=t.datas,this.count=t.count,this.statusOps=t.statusOps,this.osOps=t.osOps,this.clientOps=t.clientOps}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},rest(){console.log("rest"),this.searchForm.username="",this.searchForm.sdate="",this.searchForm.edate="",this.searchForm.status="",this.searchForm.os="",this.handleSearch()},sortChange(e){let{order:t}=e;this.idSort="ascending"===t?2:1}}},g=b,y=(r("4ef1"),Object(d["a"])(g,m,f,!1,null,"43e3b78e",null)),v=y.exports,k={name:"Audit",components:{AuditAccess:p,AuditActLog:v},mixins:[],mounted(){this.upTab()},created(){this.$emit("update:route_path",this.$route.path),this.$emit("update:route_name",["基础信息","审计日志"])},data(){return{activeName:"act_log"}},methods:{upTab(){var e=this.$route.query.tabname;e&&(this.activeName=e),this.handleClick(this.activeName)},handleClick(){switch(this.activeName){case"access_audit":this.$refs.auditAccess.setSearchData(),this.$refs.auditAccess.getData(1);break;case"act_log":this.$refs.auditActLog.getData(1);break}this.$router.push({path:this.$route.path,query:{tabname:this.activeName}})}}},_=k,F=Object(d["a"])(_,a,s,!1,null,null,null);t["default"]=F.exports},"2ba4":function(e,t,r){"use strict";var a=r("40d5"),s=Function.prototype,n=s.apply,o=s.call;e.exports="object"==typeof Reflect&&Reflect.apply||(a?o.bind(n):function(){return o.apply(n,arguments)})},3085:function(e,t,r){"use strict";r("efe3")},"3bbe":function(e,t,r){"use strict";var a=r("1787"),s=String,n=TypeError;e.exports=function(e){if(a(e))return e;throw new n("Can't set "+s(e)+" as a prototype")}},"4ef1":function(e,t,r){"use strict";r("6de2")},"577e":function(e,t,r){"use strict";var a=r("f5df"),s=String;e.exports=function(e){if("Symbol"===a(e))throw new TypeError("Cannot convert a Symbol value to a string");return s(e)}},"6de2":function(e,t,r){},"6f19":function(e,t,r){"use strict";var a=r("9112"),s=r("0d26"),n=r("b980"),o=Error.captureStackTrace;e.exports=function(e,t,r,c){n&&(o?o(e,t):a(e,"stack",s(r,c)))}},7156:function(e,t,r){"use strict";var a=r("1626"),s=r("861d"),n=r("d2bb");e.exports=function(e,t,r){var o,c;return n&&a(o=t.constructor)&&o!==r&&s(c=o.prototype)&&c!==r.prototype&&n(e,c),e}},7282:function(e,t,r){"use strict";var a=r("e330"),s=r("59ed");e.exports=function(e,t,r){try{return a(s(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(n){}}},ab36:function(e,t,r){"use strict";var a=r("861d"),s=r("9112");e.exports=function(e,t){a(t)&&"cause"in t&&s(e,"cause",t.cause)}},aeb0:function(e,t,r){"use strict";var a=r("9bf2").f;e.exports=function(e,t,r){r in e||a(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})}},b980:function(e,t,r){"use strict";var a=r("d039"),s=r("5c6c");e.exports=!a((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",s(1,7)),7!==e.stack)}))},d2bb:function(e,t,r){"use strict";var a=r("7282"),s=r("825a"),n=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{e=a(Object.prototype,"__proto__","set"),e(r,[]),t=r instanceof Array}catch(o){}return function(r,a){return s(r),n(a),t?e(r,a):r.__proto__=a,r}}():void 0)},d9e2:function(e,t,r){"use strict";var a=r("23e7"),s=r("da84"),n=r("2ba4"),o=r("e5cb"),c="WebAssembly",i=s[c],l=7!==new Error("e",{cause:7}).cause,u=function(e,t){var r={};r[e]=o(e,t,l),a({global:!0,constructor:!0,arity:1,forced:l},r)},d=function(e,t){if(i&&i[e]){var r={};r[e]=o(c+"."+e,t,l),a({target:c,stat:!0,constructor:!0,arity:1,forced:l},r)}};u("Error",(function(e){return function(t){return n(e,this,arguments)}})),u("EvalError",(function(e){return function(t){return n(e,this,arguments)}})),u("RangeError",(function(e){return function(t){return n(e,this,arguments)}})),u("ReferenceError",(function(e){return function(t){return n(e,this,arguments)}})),u("SyntaxError",(function(e){return function(t){return n(e,this,arguments)}})),u("TypeError",(function(e){return function(t){return n(e,this,arguments)}})),u("URIError",(function(e){return function(t){return n(e,this,arguments)}})),d("CompileError",(function(e){return function(t){return n(e,this,arguments)}})),d("LinkError",(function(e){return function(t){return n(e,this,arguments)}})),d("RuntimeError",(function(e){return function(t){return n(e,this,arguments)}}))},e391:function(e,t,r){"use strict";var a=r("577e");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:a(e)}},e5cb:function(e,t,r){"use strict";var a=r("d066"),s=r("1a2d"),n=r("9112"),o=r("3a9b"),c=r("d2bb"),i=r("e893"),l=r("aeb0"),u=r("7156"),d=r("e391"),h=r("ab36"),p=r("6f19"),m=r("83ab"),f=r("c430");e.exports=function(e,t,r,b){var g="stackTraceLimit",y=b?2:1,v=e.split("."),k=v[v.length-1],_=a.apply(null,v);if(_){var F=_.prototype;if(!f&&s(F,"cause")&&delete F.cause,!r)return _;var x=a("Error"),w=t((function(e,t){var r=d(b?t:e,void 0),a=b?new _(e):new _;return void 0!==r&&n(a,"message",r),p(a,w,a.stack,2),this&&o(F,this)&&u(a,this,w),arguments.length>y&&h(a,arguments[y]),a}));if(w.prototype=F,"Error"!==k?c?c(w,x):i(w,x,{name:!0}):m&&g in _&&(l(w,_,g),l(w,_,"prepareStackTrace")),i(w,_),!f)try{F.name!==k&&n(F,"name",k),F.constructor=w}catch(S){}return w}}},efe3:function(e,t,r){},f5df:function(e,t,r){"use strict";var a=r("00ee"),s=r("1626"),n=r("c6b6"),o=r("b622"),c=o("toStringTag"),i=Object,l="Arguments"===n(function(){return arguments}()),u=function(e,t){try{return e[t]}catch(r){}};e.exports=a?n:function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=u(t=i(e),c))?r:l?n(t):"Object"===(a=n(t))&&s(t.callee)?"Arguments":a}}}]);