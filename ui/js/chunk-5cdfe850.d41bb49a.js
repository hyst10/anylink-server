(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cdfe850"],{3336:function(e,t,a){"use strict";a("66d9")},"66d9":function(e,t,a){},fc3a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("el-card",[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"邮件配置",name:"dataSmtp"}},[t("el-form",{ref:"dataSmtp",staticClass:"tab-one",attrs:{model:e.dataSmtp,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"服务器地址",prop:"host"}},[t("el-input",{model:{value:e.dataSmtp.host,callback:function(t){e.$set(e.dataSmtp,"host",t)},expression:"dataSmtp.host"}})],1),t("el-form-item",{attrs:{label:"服务器端口",prop:"port"}},[t("el-input",{model:{value:e.dataSmtp.port,callback:function(t){e.$set(e.dataSmtp,"port",e._n(t))},expression:"dataSmtp.port"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.dataSmtp.username,callback:function(t){e.$set(e.dataSmtp,"username",t)},expression:"dataSmtp.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"密码为空则不修改"},model:{value:e.dataSmtp.password,callback:function(t){e.$set(e.dataSmtp,"password",t)},expression:"dataSmtp.password"}})],1),t("el-form-item",{attrs:{label:"加密类型",prop:"encryption"}},[t("el-radio-group",{model:{value:e.dataSmtp.encryption,callback:function(t){e.$set(e.dataSmtp,"encryption",t)},expression:"dataSmtp.encryption"}},[t("el-radio",{attrs:{label:"None"}},[e._v("None")]),t("el-radio",{attrs:{label:"SSLTLS"}},[e._v("SSLTLS")]),t("el-radio",{attrs:{label:"STARTTLS"}},[e._v("STARTTLS")])],1)],1),t("el-form-item",{attrs:{label:"邮件from",prop:"from"}},[t("el-input",{model:{value:e.dataSmtp.from,callback:function(t){e.$set(e.dataSmtp,"from",t)},expression:"dataSmtp.from"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("dataSmtp")}}},[e._v("保存 ")]),t("el-button",{on:{click:function(t){return e.resetForm("dataSmtp")}}},[e._v("重置")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"审计日志",name:"dataAuditLog"}},[t("el-form",{ref:"dataAuditLog",staticClass:"tab-one",attrs:{model:e.dataAuditLog,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"审计去重间隔",prop:"audit_interval"}},[t("el-input-number",{attrs:{min:-1,size:"small",label:"秒",disabled:!0},model:{value:e.dataAuditLog.audit_interval,callback:function(t){e.$set(e.dataAuditLog,"audit_interval",t)},expression:"dataAuditLog.audit_interval"}}),e._v(" 秒 "),t("p",{staticClass:"input_tip"},[e._v(" 请手动修改配置文件中的 audit_interval 参数后，再重启服务, "),t("strong",{staticStyle:{color:"#ea3323"}},[e._v("-1 代表关闭审计日志")])])],1),t("el-form-item",{attrs:{label:"存储时长",prop:"life_day"}},[t("el-input-number",{attrs:{min:0,max:365,size:"small",label:"天数"},model:{value:e.dataAuditLog.life_day,callback:function(t){e.$set(e.dataAuditLog,"life_day",t)},expression:"dataAuditLog.life_day"}}),e._v(" 天 "),t("p",{staticClass:"input_tip"},[e._v(" 范围: 0 ~ 365天 , "),t("strong",{staticStyle:{color:"#ea3323"}},[e._v("0 代表永久保存")])])],1),t("el-form-item",{attrs:{label:"清理时间",prop:"clear_time"}},[t("el-time-select",{staticStyle:{width:"130px"},attrs:{"picker-options":{start:"00:00",step:"01:00",end:"23:00"},editable:!1,size:"small",placeholder:"请选择"},model:{value:e.dataAuditLog.clear_time,callback:function(t){e.$set(e.dataAuditLog,"clear_time",t)},expression:"dataAuditLog.clear_time"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("dataAuditLog")}}},[e._v("保存 ")]),t("el-button",{on:{click:function(t){return e.resetForm("dataAuditLog")}}},[e._v("重置")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"证书设置",name:"datacertManage"}},[t("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":e.handleClick},model:{value:e.datacertManage,callback:function(t){e.datacertManage=t},expression:"datacertManage"}},[t("el-tab-pane",{attrs:{label:"自定义证书",name:"customCert"}},[t("el-form",{ref:"customCert",staticClass:"tab-one",attrs:{model:e.customCert,"label-width":"100px",size:"small"}},[t("el-form-item",[t("el-upload",{staticClass:"uploadCert",attrs:{"before-upload":e.beforeCertUpload,action:e.certUpload,limit:1}},[t("el-button",{attrs:{slot:"trigger",size:"mini",icon:"el-icon-plus"},slot:"trigger"},[e._v("证书文件 ")]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请上传 .pem 格式的 cert 文件",placement:"top"}},[t("i",{staticClass:"el-icon-info"})])],1)],1),t("el-form-item",[t("el-upload",{staticClass:"uploadCert",attrs:{"before-upload":e.beforeKeyUpload,action:e.certUpload,limit:1}},[t("el-button",{attrs:{slot:"trigger",size:"mini",icon:"el-icon-plus"},slot:"trigger"},[e._v("私钥文件 ")]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请上传 .pem 格式的 key 文件",placement:"top"}},[t("i",{staticClass:"el-icon-info"})])],1)],1),t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-upload",type:"primary"},on:{click:function(t){return e.submitForm("customCert")}}},[e._v("上传 ")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"Let's Encrypt证书",name:"letsCert"}},[t("el-form",{ref:"letsCert",staticClass:"tab-one",attrs:{model:e.letsCert,rules:e.rules,"label-width":"120px",size:"small"}},[t("el-form-item",{attrs:{label:"域名",prop:"domain"}},[t("el-input",{model:{value:e.letsCert.domain,callback:function(t){e.$set(e.letsCert,"domain",t)},expression:"letsCert.domain"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"legomail"}},[t("el-input",{model:{value:e.letsCert.legomail,callback:function(t){e.$set(e.letsCert,"legomail",t)},expression:"letsCert.legomail"}})],1),t("el-form-item",{attrs:{label:"域名服务商",prop:"name"}},[t("el-radio-group",{model:{value:e.letsCert.name,callback:function(t){e.$set(e.letsCert,"name",t)},expression:"letsCert.name"}},[t("el-radio",{attrs:{label:"aliyun"}},[e._v("阿里云")]),t("el-radio",{attrs:{label:"txcloud"}},[e._v("腾讯云")]),t("el-radio",{attrs:{label:"cfcloud"}},[e._v("cloudflare")])],1)],1),e._l(e.dnsProvider[e.letsCert.name],(function(a){return t("el-form-item",{key:a.prop,attrs:{label:a.label,rules:a.rules}},[t(a.component,{tag:"component",attrs:{type:a.type},model:{value:e.letsCert[e.letsCert.name][a.prop],callback:function(t){e.$set(e.letsCert[e.letsCert.name],a.prop,t)},expression:"letsCert[letsCert.name][component.prop]"}})],1)})),t("el-form-item",[t("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"自动续期"},model:{value:e.letsCert.renew,callback:function(t){e.$set(e.letsCert,"renew",t)},expression:"letsCert.renew"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("letsCert")}}},[e._v("申请 ")]),t("el-button",{on:{click:function(t){return e.resetForm("letsCert")}}},[e._v("重置")])],1)],2)],1)],1)],1),t("el-tab-pane",{attrs:{label:"其他设置",name:"dataOther"}},[t("el-form",{ref:"dataOther",staticClass:"tab-one",attrs:{model:e.dataOther,rules:e.rules,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"vpn对外地址",prop:"link_addr"}},[t("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.dataOther.link_addr,callback:function(t){e.$set(e.dataOther,"link_addr",t)},expression:"dataOther.link_addr"}})],1),t("el-form-item",{attrs:{label:"Banner信息",prop:"banner"}},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.dataOther.banner,callback:function(t){e.$set(e.dataOther,"banner",t)},expression:"dataOther.banner"}})],1),t("el-form-item",{attrs:{label:"自定义首页状态码",prop:"homecode"}},[t("el-input-number",{attrs:{min:0,max:1e3},model:{value:e.dataOther.homecode,callback:function(t){e.$set(e.dataOther,"homecode",t)},expression:"dataOther.homecode"}})],1),t("el-form-item",{attrs:{label:"自定义首页",prop:"homeindex"}},[t("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:e.dataOther.homeindex,callback:function(t){e.$set(e.dataOther,"homeindex",t)},expression:"dataOther.homeindex"}}),t("el-tooltip",{attrs:{content:"自定义内容可以参考 index_template 目录下的文件",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("el-form-item",{attrs:{label:"账户开通邮件模板",prop:"account_mail"}},[t("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:e.dataOther.account_mail,callback:function(t){e.$set(e.dataOther,"account_mail",t)},expression:"dataOther.account_mail"}})],1),t("el-form-item",{attrs:{label:"邮件展示"}},[t("iframe",{attrs:{width:"500px",height:"300px",srcdoc:e.dataOther.account_mail}})]),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("dataOther")}}},[e._v("保存 ")]),t("el-button",{on:{click:function(t){return e.resetForm("dataOther")}}},[e._v("重置")])],1)],1)],1)],1)],1)},l=[],s=a("bc3a"),o=a.n(s),i={name:"Other",created(){this.$emit("update:route_path",this.$route.path),this.$emit("update:route_name",["基础信息","其他设置"])},mounted(){this.getSmtp()},data(){return{activeName:"dataSmtp",datacertManage:"customCert",dataSmtp:{},dataAuditLog:{},letsCert:{domain:"",legomail:"",name:"",renew:"",aliyun:{apiKey:"",secretKey:""},txcloud:{secretId:"",secretKey:""},cfcloud:{authToken:""}},customCert:{cert:"",key:""},dataOther:{},rules:{host:{required:!0,message:"请输入服务器地址",trigger:"blur"},port:[{required:!0,message:"请输入服务器端口",trigger:"blur"},{type:"number",message:"请输入正确的服务器端口",trigger:["blur","change"]}],issuer:{required:!0,message:"请输入系统名称",trigger:"blur"},domain:{required:!0,message:"请输入需要申请证书的域名",trigger:"blur"},legomail:{required:!0,message:"请输入申请证书的邮箱地址",trigger:"blur"},name:{required:!0,message:"请选择域名服务商",trigger:"blur"}},certUpload:"/set/other/customcert",dnsProvider:{aliyun:[{label:"APIKey",prop:"apiKey",component:"el-input",type:"password",rules:{required:!0,message:"请输入正确的APIKey",trigger:"blur"}},{label:"SecretKey",prop:"secretKey",component:"el-input",type:"password",rules:{required:!0,message:"请输入正确的SecretKey",trigger:"blur"}}],txcloud:[{label:"SecretID",prop:"secretId",component:"el-input",type:"password",rules:{required:!0,message:"请输入正确的APIKey",trigger:"blur"}},{label:"SecretKey",prop:"secretKey",component:"el-input",type:"password",rules:{required:!0,message:"请输入正确的APIKey",trigger:"blur"}}],cfcloud:[{label:"AuthToken",prop:"authToken",component:"el-input",type:"password",rules:{required:!0,message:"请输入正确的AuthToken",trigger:"blur"}}]}}},methods:{handleClick(e,t){switch(window.console.log(e.name,t),e.name){case"dataSmtp":this.getSmtp();break;case"dataAuditLog":this.getAuditLog();break;case"letsCert":this.getletsCert();break;case"dataOther":this.getOther();break}},beforeCertUpload(e){this.customCert.cert=e},beforeKeyUpload(e){this.customCert.key=e},getSmtp(){o.a.get("/set/other/smtp").then(e=>{let t=e.data;console.log(t),0===t.code?this.dataSmtp=t.data:this.$message.error(t.msg)}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},getAuditLog(){o.a.get("/set/other/audit_log").then(e=>{let t=e.data;console.log(t),0===t.code?this.dataAuditLog=t.data:this.$message.error(t.msg)}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},getletsCert(){o.a.get("/set/other/getcertset").then(e=>{let t=e.data;console.log(t),0===t.code?this.letsCert=Object.assign({},this.letsCert,t.data):this.$message.error(t.msg)}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},getOther(){o.a.get("/set/other").then(e=>{let t=e.data;console.log(t),0===t.code?this.dataOther=t.data:this.$message.error(t.msg)}).catch(e=>{this.$message.error("哦，请求出错"),console.log(e)})},submitForm(e){this.$refs[e].validate(t=>{switch(t||alert("error submit!"),e){case"dataSmtp":o.a.post("/set/other/smtp/edit",this.dataSmtp).then(e=>{var t=e.data;console.log(t),0===t.code?this.$message.success(t.msg):this.$message.error(t.msg)});break;case"dataAuditLog":o.a.post("/set/other/audit_log/edit",this.dataAuditLog).then(e=>{var t=e.data;console.log(t),0===t.code?this.$message.success(t.msg):this.$message.error(t.msg)});break;case"letsCert":var a=this.$loading({lock:!0,text:"证书申请中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});o.a.post("/set/other/createcert",this.letsCert).then(e=>{var t=e.data;console.log(t),0===t.code?(a.close(),this.$message.success(t.msg)):(a.close(),this.$message.error(t.msg))});break;case"customCert":var r=new FormData;r.append("cert",this.customCert.cert),r.append("key",this.customCert.key),o.a.post(this.certUpload,r).then(e=>{var t=e.data;console.log(t),0===t.code?this.$message.success(t.msg):this.$message.error(t.msg)});break;case"dataOther":o.a.post("/set/other/edit",this.dataOther).then(e=>{var t=e.data;console.log(t),0===t.code?this.$message.success(t.msg):this.$message.error(t.msg)});break}})},resetForm(e){this.$refs[e].resetFields()}}},n=i,c=(a("3336"),a("2877")),m=Object(c["a"])(n,r,l,!1,null,"217ae0ad",null);t["default"]=m.exports}}]);